<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DAQ GUI Prototype</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="app-header">
    <div>
      <h1>로켓 지상시험 DAQ/GUI</h1>
      <p>실시간 상태 표시, 로깅, 캘리브레이션, 구성 관리까지 포함한 통합 운용 시안</p>
    </div>
    <div class="status-strip">
      <span class="status-pill connected">Connected</span>
      <span class="status-pill">Frames: 12000</span>
      <span class="status-pill">Drops: 2 (0.017%)</span>
      <span class="status-pill">CRC Errors: 0</span>
      <span class="status-pill">Queue: 42%</span>
      <span class="status-pill">NTP Sync: OK</span>
    </div>
  </header>

  <main class="layout">
    <section class="panel schematic">
      <div class="panel-header">
        <h2>추진제 공급/배관도</h2>
        <div class="legend">
          <span class="legend-item on">ON</span>
          <span class="legend-item off">OFF</span>
        </div>
      </div>
      <div class="schematic-canvas">
        <svg viewBox="0 0 900 700" aria-label="Propellant schematic">
          <defs>
            <marker id="arrow" markerWidth="10" markerHeight="10" refX="6" refY="3" orient="auto">
              <path d="M0,0 L6,3 L0,6" class="arrow-head" />
            </marker>
          </defs>

          <rect x="20" y="20" width="860" height="660" rx="18" class="frame" />

          <text x="110" y="85" class="label">GC1</text>
          <text x="270" y="85" class="label">GC2</text>
          <text x="600" y="85" class="label">GC3</text>
          <text x="760" y="85" class="label">GC4</text>

          <rect x="70" y="110" width="110" height="200" rx="44" class="tank tank-left" />
          <rect x="230" y="110" width="110" height="200" rx="44" class="tank tank-left" />
          <rect x="560" y="110" width="110" height="200" rx="44" class="tank tank-right" />
          <rect x="720" y="110" width="110" height="200" rx="44" class="tank tank-right" />

          <line x1="125" y1="110" x2="125" y2="70" class="vent" marker-end="url(#arrow)" />
          <line x1="285" y1="110" x2="285" y2="70" class="vent" marker-end="url(#arrow)" />
          <line x1="615" y1="110" x2="615" y2="70" class="vent" marker-end="url(#arrow)" />
          <line x1="775" y1="110" x2="775" y2="70" class="vent" marker-end="url(#arrow)" />

          <line x1="125" y1="310" x2="125" y2="360" class="pipe" />
          <line x1="285" y1="310" x2="285" y2="360" class="pipe" />
          <line x1="615" y1="310" x2="615" y2="360" class="pipe" />
          <line x1="775" y1="310" x2="775" y2="360" class="pipe" />

          <line x1="125" y1="360" x2="775" y2="360" class="pipe" />

          <line x1="450" y1="360" x2="450" y2="520" class="pipe" />
          <line x1="260" y1="520" x2="640" y2="520" class="pipe" />
          <line x1="450" y1="520" x2="450" y2="600" class="pipe" />

          <circle cx="450" cy="420" r="14" class="valve" />
          <circle cx="450" cy="470" r="14" class="valve" />
          <text x="474" y="425" class="label small">GCFV</text>
          <text x="474" y="475" class="label small">GCOV</text>

          <text x="92" y="330" class="label small">BV1</text>
          <text x="92" y="346" class="valve-label on" data-valve="BV1">ON</text>

          <text x="232" y="330" class="label small">BV2</text>
          <text x="232" y="346" class="valve-label off" data-valve="BV2">OFF</text>

          <text x="642" y="330" class="label small">BV3</text>
          <text x="642" y="346" class="valve-label off" data-valve="BV3">OFF</text>

          <text x="782" y="330" class="label small">BV4</text>
          <text x="782" y="346" class="valve-label on" data-valve="BV4">ON</text>

          <text x="230" y="405" class="label small">GCFV</text>
          <text x="230" y="421" class="valve-label off" data-valve="GCFV">OFF</text>

          <text x="600" y="405" class="label small">GCOV</text>
          <text x="600" y="421" class="valve-label on" data-valve="GCOV">ON</text>

          <text x="420" y="520" class="label small">MFV</text>
          <text x="420" y="536" class="valve-label off" data-valve="MFV">OFF</text>

          <text x="470" y="520" class="label small">MOV</text>
          <text x="470" y="536" class="valve-label on" data-valve="MOV">ON</text>

          <circle cx="450" cy="610" r="28" class="engine" />
          <text x="430" y="655" class="label small">ENGINE</text>

          <rect x="50" y="370" width="78" height="26" rx="6" class="sensor" />
          <text x="58" y="388" class="sensor-text">P3 0.00</text>
          <rect x="770" y="370" width="78" height="26" rx="6" class="sensor" />
          <text x="778" y="388" class="sensor-text">P4 0.00</text>

          <rect x="360" y="540" width="86" height="26" rx="6" class="sensor" />
          <text x="368" y="558" class="sensor-text">DP1 0.00</text>
          <rect x="454" y="540" width="86" height="26" rx="6" class="sensor" />
          <text x="462" y="558" class="sensor-text">DP2 0.00</text>

          <rect x="360" y="580" width="86" height="26" rx="6" class="sensor" />
          <text x="368" y="598" class="sensor-text">L1 0.0</text>
          <rect x="454" y="580" width="110" height="26" rx="6" class="sensor" />
          <text x="462" y="598" class="sensor-text">유량 0.0 g/s</text>

          <text x="118" y="430" class="label small">T1</text>
          <text x="438" y="545" class="label small">T2</text>
          <text x="742" y="430" class="label small">T3</text>

          <circle cx="450" cy="620" r="28" class="engine" />
          <text x="430" y="665" class="label small">ENGINE</text>

          <rect x="95" y="60" width="72" height="26" rx="6" class="sensor" />
          <text x="103" y="78" class="sensor-text">P1 0.00</text>
          <rect x="725" y="60" width="72" height="26" rx="6" class="sensor" />
          <text x="733" y="78" class="sensor-text">P2 0.00</text>
        </svg>

        <div class="valve-panel">
          <button class="valve-btn on" data-state="on" data-valve="BV1">BV1 <span>ON</span></button>
          <button class="valve-btn off" data-state="off" data-valve="BV2">BV2 <span>OFF</span></button>
          <button class="valve-btn off" data-state="off" data-valve="BV3">BV3 <span>OFF</span></button>
          <button class="valve-btn on" data-state="on" data-valve="BV4">BV4 <span>ON</span></button>
          <button class="valve-btn off" data-state="off" data-valve="GCFV">GCFV <span>OFF</span></button>
          <button class="valve-btn on" data-state="on" data-valve="GCOV">GCOV <span>ON</span></button>
          <button class="valve-btn off" data-state="off" data-valve="MFV">MFV <span>OFF</span></button>
          <button class="valve-btn on" data-state="on" data-valve="MOV">MOV <span>ON</span></button>
        </div>
      </div>
    </section>

    <section class="panel status">
      <div class="panel-header">
        <h2>운용 상태 & 알람</h2>
      </div>
      <div class="status-grid">
        <div class="status-card">
          <h3>연결/동기화</h3>
          <ul>
            <li>USB 링크 상태: 안정적</li>
            <li>NTP/PTP 동기: 0.8 ms</li>
            <li>재연결 횟수: 0</li>
          </ul>
          <div class="toggle-row">
            <button class="toggle-btn on" data-state="on">Auto Reconnect <span>ON</span></button>
            <button class="toggle-btn on" data-state="on">Drop Monitor <span>ON</span></button>
          </div>
        </div>
        <div class="status-card">
          <h3>경고 및 인터락</h3>
          <ul class="alarm-list">
            <li class="alarm warning">P1 저압 경고 (임계치 50psi)</li>
            <li class="alarm ok">CRC 정상</li>
            <li class="alarm ok">파일 저장 공간 78% 여유</li>
          </ul>
          <div class="toggle-row">
            <button class="toggle-btn off" data-state="off">Emergency Stop <span>OFF</span></button>
            <button class="toggle-btn on" data-state="on">Interlock <span>ON</span></button>
          </div>
        </div>
        <div class="status-card">
          <h3>큐/처리량</h3>
          <div class="meter">
            <span>큐 사용량</span>
            <div class="bar">
              <div class="bar-fill" style="width: 42%"></div>
            </div>
          </div>
          <div class="meter">
            <span>디스크 기록 속도</span>
            <div class="bar">
              <div class="bar-fill" style="width: 68%"></div>
            </div>
          </div>
          <div class="meter">
            <span>GUI 업데이트 주기</span>
            <div class="bar">
              <div class="bar-fill" style="width: 75%"></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel logging">
      <div class="panel-header">
        <h2>세션 로깅 & 메타데이터</h2>
      </div>
      <div class="logging-grid">
        <div class="logging-card">
          <h3>세션 관리</h3>
          <div class="kv">
            <span>세션 ID</span>
            <span>2026-02-05_run07</span>
          </div>
          <div class="kv">
            <span>파일 포맷</span>
            <span>CSV + HDF5</span>
          </div>
          <div class="kv">
            <span>파일 위치</span>
            <span>D:/DAQ/logs/</span>
          </div>
          <div class="toggle-row">
            <button class="toggle-btn on" data-state="on">Logging <span>ON</span></button>
            <button class="toggle-btn on" data-state="on">Batch Write <span>ON</span></button>
          </div>
        </div>
        <div class="logging-card">
          <h3>시험 메타데이터</h3>
          <div class="form-grid">
            <div>
              <label>시험명</label>
              <input type="text" value="LOX/CH4 cold-flow" />
            </div>
            <div>
              <label>담당자</label>
              <input type="text" value="J. Doe" />
            </div>
            <div>
              <label>시험장</label>
              <input type="text" value="Pad A" />
            </div>
            <div>
              <label>버전</label>
              <input type="text" value="DAQ v2.1" />
            </div>
          </div>
        </div>
        <div class="logging-card">
          <h3>채널 요약</h3>
          <table class="channel-table">
            <thead>
              <tr>
                <th>채널</th>
                <th>단위</th>
                <th>보정</th>
                <th>표시</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>ChamberPressure</td>
                <td>psi</td>
                <td>scale 0.0987</td>
                <td><span class="chip good">ON</span></td>
              </tr>
              <tr>
                <td>FuelTemp</td>
                <td>℃</td>
                <td>offset -100</td>
                <td><span class="chip good">ON</span></td>
              </tr>
              <tr>
                <td>OxFlow</td>
                <td>kg/s</td>
                <td>scale 1.02</td>
                <td><span class="chip warn">LIMIT</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="panel report">
      <div class="panel-header">
        <h2>설계 보고서 요약</h2>
      </div>
      <div class="report-grid">
        <article>
          <h3>설계 목표 및 범위</h3>
          <p>STM32 기반 센서 데이터를 실시간으로 수집/표시하고 안전하게 저장하며, 신뢰성·실시간성·확장성을 확보합니다.</p>
        </article>
        <article>
          <h3>계층 구조</h3>
          <ul>
            <li>하드웨어/통신/처리/파이프라인/프레젠테이션 계층으로 분리</li>
            <li>Producer-Consumer 구조로 데이터 흐름 분산</li>
          </ul>
        </article>
        <article>
          <h3>로깅 및 세션 관리</h3>
          <ul>
            <li>세션 단위 파일 분리, 메타데이터 포함</li>
            <li>CSV/HDF5/MDF 포맷 지원 및 export 전략</li>
          </ul>
        </article>
        <article>
          <h3>캘리브레이션</h3>
          <ul>
            <li>장기/단기 보정 분리, 버전 관리</li>
            <li>Zero/Span 보정 UI 제공</li>
          </ul>
        </article>
        <article>
          <h3>신뢰성 기능</h3>
          <ul>
            <li>자동 재연결, 드롭/CRC 감지</li>
            <li>상태 카드에 지표 표시</li>
          </ul>
        </article>
        <article>
          <h3>확장 고려</h3>
          <ul>
            <li>제어 계층 분리 및 외부 시스템 연계</li>
            <li>자동 분석/리포트 생성 준비</li>
          </ul>
        </article>
        <article>
          <h3>보안/권한</h3>
          <ul>
            <li>로그 파일 접근 권한 관리</li>
            <li>원격 전송 TLS 적용</li>
          </ul>
        </article>
        <article>
          <h3>데이터 흐름</h3>
          <ul>
            <li>Producer → 내부 큐 → Logger/GUI Consumer</li>
            <li>세션 종료 시 자동 보고서 생성</li>
          </ul>
        </article>
      </div>
    </section>

    <section class="panel config">
      <div class="panel-header">
        <h2>설정 & 캘리브레이션</h2>
      </div>
      <div class="config-grid">
        <div class="config-card">
          <h4>구성 프로파일</h4>
          <div class="kv">
            <span>활성 프로파일</span>
            <span>Engine_A</span>
          </div>
          <div class="kv">
            <span>업데이트</span>
            <span>2026-02-05 09:41</span>
          </div>
          <div class="toggle-row">
            <button class="toggle-btn on" data-state="on">Auto Load <span>ON</span></button>
            <button class="toggle-btn off" data-state="off">Lock <span>OFF</span></button>
          </div>
        </div>
        <div class="config-card">
          <h4>채널 레지스트리</h4>
          <div class="kv">
            <span>ChamberPressure</span>
            <span>psi · scale 0.1 · offset 0.0</span>
          </div>
          <div class="kv">
            <span>FuelTemp</span>
            <span>℃ · scale 0.01 · offset -100</span>
          </div>
          <div class="kv">
            <span>OxValve</span>
            <span>state · on/off</span>
          </div>
        </div>
        <div class="config-card">
          <h4>세션 정보</h4>
          <div class="kv">
            <span>Session</span>
            <span>20260205_test1.mdf</span>
          </div>
          <div class="kv">
            <span>Operator</span>
            <span>J. Doe</span>
          </div>
          <div class="kv">
            <span>Format</span>
            <span>HDF5 + CSV export</span>
          </div>
        </div>
        <div class="config-card">
          <h4>캘리브레이션</h4>
          <div class="kv">
            <span>Long-term</span>
            <span>scale 0.0987 / offset 0.0</span>
          </div>
          <div class="kv">
            <span>Short-term</span>
            <span>zero offset +0.5 psi</span>
          </div>
          <div class="kv">
            <span>버전</span>
            <span>V2.3</span>
          </div>
          <button class="secondary">Zero Calibrate Now</button>
          <button class="secondary">Span Calibrate Now</button>
        </div>
      </div>
    </section>
  </main>

  <script src="app.js"></script>
</body>
</html>
